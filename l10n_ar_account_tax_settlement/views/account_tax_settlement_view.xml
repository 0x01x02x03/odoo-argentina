<?xml version='1.0' encoding='UTF-8'?>
<openerp>
	<data>
        <record model='ir.ui.view' id='account_tax_settlement_tree'>
            <field name='name'>Account Tax Settlement</field> 
            <field name="model">account.tax.settlement</field>
            <field name='arch' type='xml'>
                <tree colors="blue:state == 'draft';gray:state == 'cancel'" string="Tax Settlement">
                    <field name="journal_id"/>
                    <field name="fiscalyear_id"/>
                    <!-- <field name="period_id"/> -->
                    <field name="company_id" groups="base.group_multi_company"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

		<record model='ir.ui.view' id='account_tax_settlement_form'>
			<field name='name'>Account Tax Settlement</field> 
            <field name="model">account.tax.settlement</field>
			<field name='arch' type='xml'>
	            <form string="Tax Settlement">
                    <header>
                        <!-- <button name="action_print" string="Print" states="draft" type="object" class="oe_highlight"/> -->
                        <!-- <button name="action_print" string="Print" states="cancel,presented" type="object"/> -->
                        <button name="action_present" string="Present" states="draft" type="object" class="oe_highlight"/>
                        <button name="action_cancel" string="Cancel" states="draft,presented" type="object"/>
                        <button name="action_to_draft" string="To Draft" states="cancel" type="object"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,presented"/>
                    </header>
                    <sheet>
                        <group>
                           <group>
                                <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                                <field name="journal_id" domain="[('type', '=', 'general'), ('tax_code_id', '!=', False), ('company_id', '=', company_id)]"/>
                                <field name="fiscalyear_id" domain="[('company_id','=',company_id)]"/>
                                <field name="moves_state"/>
                                <field name="date"/>
                                <field name="period_id"/>
                            </group>
                            <group>
                                <field name="filter"/>
                                <label for="date_from" string="Dates" attrs="{'invisible':[('filter', '!=', 'filter_date')]}"/>
                                <div attrs="{'invisible':[('filter', '!=', 'filter_date')]}" name="date_from">
                                    <field name="date_from" attrs="{'required':[('filter', '=', 'filter_date')]}" class="oe_inline"/>-
                                    <field name="date_to" attrs="{'required':[('filter', '=', 'filter_date')]}" class="oe_inline"/>
                                </div>
                                <field name="period_ids" widget="many2many_tags" attrs="{'required':[('filter', '=', 'filter_period')],'invisible':[('filter', '!=', 'filter_period')]}" class="oe_inline" domain="[('fiscalyear_id', '=', fiscalyear_id)]"/>
                                <field name="balance_amount"/>
                                <field name="balance_tax_amount"/>
                                <field name="balance_account_id"/>
                                <!-- <label for="period_from_id" string="Periods" attrs="{'invisible':[('filter', '!=', 'filter_period')]}"/> -->
                                <!-- <div attrs="{'invisible':[('filter', '!=', 'filter_period')]}" name="period_range">
                                    <field name="period_from_id" attrs="{'required':[('filter', '=', 'filter_period')]}" class="oe_inline" domain="[('fiscalyear_id', '=', fiscalyear_id)]"/>-
                                    <field name="period_to_id" attrs="{'required':[('filter', '=', 'filter_period')]}" class="oe_inline" domain="[('fiscalyear_id', '=', fiscalyear_id)]"/>
                                </div> -->
                            </group>
                            <group>
                            </group>
    	                </group>
    	                <notebook>
                            <page string="Move Lines" name="move_lines">
                                <button name="compute" type="object" string="Compute"/>
                                <field name="tax_settlement_detail_ids">
                                <!-- <field name="move_line_ids"> -->
<!--                                     <tree default_order="date_invoice">
                                        <field name="state" invisible="1"/>
                                        <field name="date_invoice"/>
                                        <field name="document_number"/>
                                        <field name="commercial_partner_id"/>
                                        <field name="responsability_id"/>
                                        <field name="formated_vat"/>
                                        <field name="amount_untaxed" sum="Total"/>
                                        <field name="amount_tax" sum="Total"/>
                                        <field name="amount_total" sum="Total"/>
                                    </tree> -->
                                </field>
                            </page>
                            <page string="asdasd">
                                <group>
                                    <field name="move_id"/>
                                </group>
                                <field name="move_line_ids">
                                    <tree colors="blue:state == 'draft';black:state == 'posted'" editable="top" string="Journal Items">
                                        <field name="name"/>
                                        <field name="partner_id" domain="['|', ('parent_id', '=', False), ('is_company', '=', True)]" on_change="onchange_partner_id(False, partner_id, account_id, debit, credit, parent.date, parent.journal_id, context)"/>
                                        <field name="account_id" domain="[('journal_id','=',parent.journal_id),('company_id', '=', parent.company_id)]"/>
                                        <field name="date_maturity"/>
                                        <field name="debit" sum="Total Debit"/>
                                        <field name="credit" sum="Total Credit"/>
                                        <field name="analytic_account_id" groups="analytic.group_analytic_accounting"/>
                                        <field name="tax_code_id"/>
                                        <field name="tax_amount" sum="Total Tax"/>
                                        <field name="state" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <!-- <page string="Summary" name="summary">
                                <label for="document_class_ids"/>
                                <field name="document_class_ids" context="{'tax_settlement_id': active_id}">
                                    <tree>
                                        <field name="name"/>
                                        <field name="amount_untaxed" sum="Total"/>
                                        <field name="amount_tax" sum="Total"/>
                                        <field name="amount_total" sum="Total"/>
                                    </tree>
                                </field>
                                <label for="responsability_ids"/>
                                <field name="responsability_ids" context="{'tax_settlement_id': active_id}">
                                    <tree>
                                        <field name="name"/>
                                        <field name="amount_untaxed" sum="Total"/>
                                        <field name="amount_tax" sum="Total"/>
                                        <field name="amount_total" sum="Total"/>
                                    </tree>
                                </field>
                                <label for="vat_tax_code_ids"/>
                                <field name="vat_tax_code_ids" context="{'tax_settlement_id': active_id}">
                                    <tree>
                                        <field name="name"/>
                                        <field name="amount_untaxed" sum="Total"/>
                                        <field name="amount_tax" sum="Total"/>
                                    </tree>
                                </field>
                                <group>
                                    <group attrs="{'invisible':[('other_taxes_amount','=',False)]}">
                                        <label for="other_taxes_base" string="Other Taxes"/>
                                        <div>
                                            (<field name="other_taxes_base"  class="oe_inline"/>)
                                            <field name="other_taxes_amount" class="oe_inline"/>
                                        </div>
                                    </group>
                                </group>
                            </page> -->
    	                    <page string="Notes" name="notes">
    	                        <field name="note"/>
    	                    </page>
    	                </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
	            </form>
			</field>
		</record>

		<record id="action_account_vat_settlement" model="ir.actions.act_window">
			<field name="name">Tax Settlement</field>
			<field name="res_model">account.tax.settlement</field>
        </record>

        <menuitem id="account_tax_settlement_menu"
                  name="Tax Settlements"
                  parent="account.menu_finance_periodical_processing"
                  action="action_account_vat_settlement"
                  sequence="40"/>
                        
	</data>
</openerp>